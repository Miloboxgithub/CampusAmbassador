{"version":3,"file":"preview.js","sources":["pkgA/preview/preview.vue","../../../../../HBuilderX.4.15.2024050802/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGtnQVxwcmV2aWV3XHByZXZpZXcudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"page-container\">\r\n\t\t<view class=\"moban\">\r\n\t\t\t<img class=\"moban-img\" :src=\"TemplateImg\" alt=\"\" />\r\n\t\t\t<view class=\"line\"></view>\r\n\t\t\t<text class=\"data\"> {{viewCount}} 人浏览过 | {{downloadNumber}} 人使用过</text>\r\n\t\t</view>\r\n\t</view>\r\n\t<view class=\"bottom\">\r\n\t\t<button open-type=\"share\" class=\"btns\"><img src=\"../../static/share.png\" alt=\"\" class=\"share\" />\r\n\t\t</button><text class=\"ss\">分享</text>\r\n\t\t<img :src=\"isCollected ? '../../static/collected.png' : '../../static/collect.png'\" @click=\" collectsClick\"\r\n\t\t\talt=\"\" class=\"collects\" />\r\n\t\t<text class=\"cc\">收藏</text>\r\n\t\t<view class=\"btn\" @click=\"downloadWord\"> 下载word模板 </view>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref\r\n\t} from \"vue\";\r\n\timport {\r\n\t\tonLoad,\r\n\t\tonShareAppMessage\r\n\t} from '@dcloudio/uni-app';\r\n\timport {\r\n\t\tgetResumeTemplateDetail,\r\n\t\tgetResumeTemplateLink,\r\n\t\tgetResumeTemplateUseCount,\r\n\t\taddResumeTemplateUseCount,\r\n\t\tgetResumeViewCount,\r\n\t\taddResumeViewCount,\r\n\t\tcollectResumeTemplate,\r\n\t\toffCollectResumeTemplate\r\n\t} from \"@/api/index.js\";\r\n\timport {\r\n\t\tpageStore\r\n\t} from \"@/store\";\r\n\timport Loading from \"@/components/Loading.vue\";\r\nimport Template from \"../../pages/template/template.vue\";\r\n\tconst isLoading = ref(false);\r\n\tconst id = ref(null);\r\n\tconst TemplateImg = ref(\"../../static/template.png\"); // 模板图片路径\r\n\tconst downloadNumber = ref(0); // 下载次数\r\n\tconst isCollected = ref(false); // 是否已收藏\r\n\tconst downloadUrl = ref(\"\"); // 下载链接\r\n\tconst shareData = ref()\r\n\tconst viewCount = ref(0); // 浏览次数\r\n\tonLoad(async (option) => {\r\n\t\twx.showShareMenu({\r\n\t\t\twithShareTicket: true,\r\n\t\t\t//设置下方的Menus菜单，才能够让发送给朋友与分享到朋友圈两个按钮可以点击\r\n\t\t\tmenus: [\"shareAppMessage\", \"shareTimeline\"]\r\n\t\t})\r\n\t\tisLoading.value = true; // 显示加载状态\r\n\t\tid.value = option.id; // 获取传递的 id\r\n\t\tconsole.log(\"接收到的 id:\", id.value);\r\n\t\tconst res = await getResumeTemplateDetail(id.value);\r\n\t\tconsole.log(\"获取到的详情:\", res);\r\n\t\tif (res.statusCode === 200&&res.data.code==1) {\r\n\t\t\tisLoading.value = false; // 隐藏加载状态\r\n\t\t\t// 处理获取到的模板详情数据\r\n\t\t\tlet info = res.data.data;\r\n\t\t\tTemplateImg.value = \"https://api.xydsh.cn/img/\"+info.templateSampleGraph; // 设置模板图片路径\r\n\t\t\tdownloadNumber.value = info.usageCount; // 设置下载次数\r\n\t\t\tisCollected.value = info.isFavorite; // 设置收藏状态\r\n\t\t\tdownloadUrl.value = info.shareLinks.web.shareLink; // 设置下载链接\r\n\t\t\tshareData.value = info.shareLinks.miniapp; // 设置分享数据\r\n\t\t\tviewCount.value = info.viewCount; // 设置浏览次数\r\n\t\t} else {\r\n\t\t\tisLoading.value = false; // 隐藏加载状态\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: \"获取详情失败\",\r\n\t\t\t\ticon: \"error\",\r\n\t\t\t});\r\n\t\t}\r\n\t\t// 增加浏览次数\r\n\t\tawait addResumeViewCount(id.value);\r\n\t});\r\n\t\r\n\tconst collectsClick = async () => {\r\n\t\tif(!isCollected.value){\r\n\t\t\t// 如果当前未收藏，则执行收藏操作\r\n\t\t\tconst res  = await collectResumeTemplate(id.value);\r\n\t\t\tif(res.statusCode == 200 || res.data.code == 1) {\r\n\t\t\t\tisCollected.value = !isCollected.value; // 切换收藏状态\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: \"收藏成功\",\r\n\t\t\t\t\ticon: \"success\"\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// 如果当前已收藏，则执行取消收藏操作\r\n\t\t\tconst res  = await offCollectResumeTemplate(id.value);\r\n\t\t\tif(res.statusCode == 200 || res.data.code == 1) {\r\n\t\t\t\tisCollected.value = !isCollected.value; // 切换收藏状态\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: \"取消收藏成功\",\r\n\t\t\t\t\ticon: \"success\"\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\r\n\t};\r\n\tconst downloadWord = () => {\r\n\t\tif (!downloadUrl.value) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: \"下载链接不存在\",\r\n\t\t\t\ticon: \"none\"\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// 将下载链接复制到剪贴板\r\n\t\tuni.setClipboardData({\r\n\t\t\tdata: downloadUrl.value,\r\n\t\t\tsuccess: () => {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: \"下载链接已复制成功，请在外部浏览器中粘贴链接下载\",\r\n\t\t\t\t\ticon: \"none\"\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tfail: () => {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: \"复制链接失败，请手动复制\",\r\n\t\t\t\t\ticon: \"none\"\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tonShareAppMessage(async() => {\r\n\t\t\r\n\t\treturn {\r\n\t\t\ttitle: shareData.value.templateName, // 分享标题\r\n\t\t\tpath: `/pkgA/preview/preview?id=${id.value}`, // 分享路径\r\n\t\t\timageUrl: shareData.value.templateSampleGraph, // 分享图片\r\n\t\t}\r\n\t})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.collects:active {\r\n\t\ttransform: scale(1.3);\r\n\t\t/* 点击时的放大效果 */\r\n\t}\r\n\r\n\t.page-container {\r\n\t\tbackground: rgb(245, 245, 245);\r\n\t\theight: 100vh;\r\n\t\t/* 使用视口高度确保填充整个页面 */\r\n\t\twidth: 100vw;\r\n\t\t/* 使用视口宽度确保填充整个页面 */\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.moban {\r\n\t\twidth: 92%;\r\n\t\theight: 524px;\r\n\t\topacity: 1;\r\n\t\tposition: absolute;\r\n\t\toverflow: hidden;\r\n\t\ttop: 8px;\r\n\t\tborder-radius: 15px;\r\n\t\tbackground: rgba(255, 255, 255, 1);\r\n\t\tbox-shadow: 0px 2px 4px rgba(0, 0, 0, 0.05);\r\n\t}\r\n\r\n\t.line {\r\n\t\tposition: absolute;\r\n\t\tbottom: 31.5px;\r\n\t\twidth: 100%;\r\n\t\theight: 0px;\r\n\t\topacity: 1;\r\n\t\tborder: 0.01px solid rgba(0, 0, 0, 0.3);\r\n\t}\r\n\r\n\t.moban-img {\r\n\t\tposition: absolute;\r\n\t\tleft: 50%;\r\n\t\ttransform: translateX(-50%);\r\n\t\ttop: 5px;\r\n\t\twidth: 96%;\r\n\t\theight: 475.24px;\r\n\t\topacity: 1;\r\n\t}\r\n\r\n\t.data {\r\n\t\t/** 文本1 */\r\n\t\tfont-size: 10px;\r\n\t\tfont-weight: 400;\r\n\t\tletter-spacing: 0px;\r\n\t\tline-height: 14.48px;\r\n\t\tcolor: rgba(166, 166, 166, 1);\r\n\t\ttext-align: center;\r\n\t\tvertical-align: top;\r\n\t\tposition: absolute;\r\n\t\tleft: 18px;\r\n\t\tbottom: 9px;\r\n\t}\r\n\r\n\t.line {\r\n\t\tposition: absolute;\r\n\t\tbottom: 32px;\r\n\r\n\t\twidth: 100%;\r\n\t\theight: 0px;\r\n\t\topacity: 1;\r\n\t\tborder: 0.01px solid rgba(0, 0, 0, 0.3);\r\n\t}\r\n\r\n\t.bottom {\r\n\t\tposition: fixed;\r\n\t\tbottom: 0;\r\n\t\twidth: 100vw;\r\n\t\theight: 79px;\r\n\t\topacity: 1;\r\n\t\tbackground: rgba(255, 255, 255, 1);\r\n\t}\r\n\r\n\t.share {\r\n\t\tposition: absolute;\r\n\t\tleft: 0px;\r\n\t\tbottom: 0px;\r\n\t\twidth: 23px;\r\n\t\theight: 23px;\r\n\t}\r\n\r\n\t.btns {\r\n\t\tposition: absolute;\r\n\t\tleft: 41px;\r\n\t\tbottom: 37px;\r\n\t\tbackground-color: rgba(255, 255, 255, 1);\r\n\t\twidth: 30px;\r\n\t\theight: 30px;\r\n\t\t/* 移除默认样式 */\r\n\t\tborder: none;\r\n\t\tborder-radius: 0;\r\n\t\tpadding: 0;\r\n\t\tmargin: 0;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.btns::after {\r\n\t\tborder: none;\r\n\t}\r\n\r\n\t.ss {\r\n\t\tposition: absolute;\r\n\t\tleft: 41px;\r\n\t\tbottom: 17px;\r\n\t\tfont-size: 13px;\r\n\t\tfont-weight: 400;\r\n\t\tletter-spacing: 0px;\r\n\t\tline-height: 18.82px;\r\n\t\tcolor: rgba(56, 56, 56, 0.8);\r\n\t\ttext-align: left;\r\n\t\tvertical-align: top;\r\n\t}\r\n\r\n\t.collects {\r\n\t\ttransition: transform 0.3s ease, color 0.3s ease;\r\n\t\tposition: absolute;\r\n\t\tleft: 30%;\r\n\t\tbottom: 37px;\r\n\t\twidth: 25px;\r\n\t\theight: 23.97px;\r\n\t\topacity: 1;\r\n\t}\r\n\r\n\t.cc {\r\n\t\tposition: absolute;\r\n\t\tleft: 30%;\r\n\t\tbottom: 17px;\r\n\t\tfont-size: 13px;\r\n\t\tfont-weight: 400;\r\n\t\tletter-spacing: 0px;\r\n\t\tline-height: 18.82px;\r\n\t\tcolor: rgba(56, 56, 56, 0.8);\r\n\t\ttext-align: left;\r\n\t\tvertical-align: top;\r\n\t}\r\n\r\n\t.btn {\r\n\t\tposition: absolute;\r\n\t\tbottom: 22px;\r\n\t\tright: 19px;\r\n\t\twidth: 40%;\r\n\t\theight: 38px;\r\n\t\topacity: 1;\r\n\t\tborder-radius: 19px;\r\n\t\tbackground: linear-gradient(90deg,\r\n\t\t\t\trgba(79, 120, 255, 1) 0%,\r\n\t\t\t\trgba(79, 120, 255, 0.7) 100%);\r\n\t\tfont-size: 14px;\r\n\t\tfont-weight: 500;\r\n\t\tletter-spacing: 0px;\r\n\t\tline-height: 20.27px;\r\n\t\tcolor: rgba(255, 255, 255, 1);\r\n\t\ttext-align: center;\r\n\t\tvertical-align: top;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n</style>","import MiniProgramPage from 'C:/Users/86158/Documents/HBuilderProjects/CampusAmbassador/pkgA/preview/preview.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onLoad","wx","uni","getResumeTemplateDetail","addResumeViewCount","collectResumeTemplate","offCollectResumeTemplate","onShareAppMessage"],"mappings":";;;;;;;;AAmBA,UAAA,YAAAA,kBAAA,KAAA;AAuBA,UAAA,KAAAA,kBAAA,IAAA;AACA,UAAA,cAAAA,kBAAA,2BAAA;AACA,UAAA,iBAAAA,kBAAA,CAAA;AACA,UAAA,cAAAA,kBAAA,KAAA;AACA,UAAA,cAAAA,kBAAA,EAAA;AACA,UAAA,YAAAA,cAAAA,IAAA;AACA,UAAA,YAAAA,kBAAA,CAAA;AACAC,kBAAA,OAAA,OAAA,WAAA;AACAC,oBAAAA,KAAA,cAAA;AAAA,QACA,iBAAA;AAAA;AAAA,QAEA,OAAA,CAAA,mBAAA,eAAA;AAAA,MACA,CAAA;AACA,gBAAA,QAAA;AACA,SAAA,QAAA,OAAA;AACAC,oBAAA,MAAA,MAAA,OAAA,kCAAA,YAAA,GAAA,KAAA;AACA,YAAA,MAAA,MAAAC,UAAAA,wBAAA,GAAA,KAAA;AACAD,oBAAA,MAAA,MAAA,OAAA,kCAAA,WAAA,GAAA;AACA,UAAA,IAAA,eAAA,OAAA,IAAA,KAAA,QAAA,GAAA;AACA,kBAAA,QAAA;AAEA,YAAA,OAAA,IAAA,KAAA;AACA,oBAAA,QAAA,8BAAA,KAAA;AACA,uBAAA,QAAA,KAAA;AACA,oBAAA,QAAA,KAAA;AACA,oBAAA,QAAA,KAAA,WAAA,IAAA;AACA,kBAAA,QAAA,KAAA,WAAA;AACA,kBAAA,QAAA,KAAA;AAAA,MACA,OAAA;AACA,kBAAA,QAAA;AACAA,sBAAAA,MAAA,UAAA;AAAA,UACA,OAAA;AAAA,UACA,MAAA;AAAA,QACA,CAAA;AAAA,MACA;AAEA,YAAAE,UAAA,mBAAA,GAAA,KAAA;AAAA,IACA,CAAA;AAEA,UAAA,gBAAA,YAAA;AACA,UAAA,CAAA,YAAA,OAAA;AAEA,cAAA,MAAA,MAAAC,UAAAA,sBAAA,GAAA,KAAA;AACA,YAAA,IAAA,cAAA,OAAA,IAAA,KAAA,QAAA,GAAA;AACA,sBAAA,QAAA,CAAA,YAAA;AACAH,wBAAAA,MAAA,UAAA;AAAA,YACA,OAAA;AAAA,YACA,MAAA;AAAA,UACA,CAAA;AACA;AAAA,QACA;AAAA,MACA,OAAA;AAEA,cAAA,MAAA,MAAAI,UAAAA,yBAAA,GAAA,KAAA;AACA,YAAA,IAAA,cAAA,OAAA,IAAA,KAAA,QAAA,GAAA;AACA,sBAAA,QAAA,CAAA,YAAA;AACAJ,wBAAAA,MAAA,UAAA;AAAA,YACA,OAAA;AAAA,YACA,MAAA;AAAA,UACA,CAAA;AACA;AAAA,QACA;AAAA,MACA;AAAA,IAIA;AACA,UAAA,eAAA,MAAA;AACA,UAAA,CAAA,YAAA,OAAA;AACAA,sBAAAA,MAAA,UAAA;AAAA,UACA,OAAA;AAAA,UACA,MAAA;AAAA,QACA,CAAA;AACA;AAAA,MACA;AAEAA,oBAAAA,MAAA,iBAAA;AAAA,QACA,MAAA,YAAA;AAAA,QACA,SAAA,MAAA;AACAA,wBAAAA,MAAA,UAAA;AAAA,YACA,OAAA;AAAA,YACA,MAAA;AAAA,UACA,CAAA;AAAA,QACA;AAAA,QACA,MAAA,MAAA;AACAA,wBAAAA,MAAA,UAAA;AAAA,YACA,OAAA;AAAA,YACA,MAAA;AAAA,UACA,CAAA;AAAA,QACA;AAAA,MACA,CAAA;AAAA,IACA;AACAK,kBAAAA,kBAAA,YAAA;AAEA,aAAA;AAAA,QACA,OAAA,UAAA,MAAA;AAAA;AAAA,QACA,MAAA,4BAAA,GAAA,KAAA;AAAA;AAAA,QACA,UAAA,UAAA,MAAA;AAAA;AAAA,MACA;AAAA,IACA,CAAA;;;;;;;;;;;;;;;;AC5IA,GAAG,WAAW,eAAe;"}